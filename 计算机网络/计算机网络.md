# 计算机网络

## 一、基本概念

### 1.计算机之间的通信

> * 需要得知对方的 地址 
> * 最终是根据**MAC地址**（**网卡地址**），输送数据到网卡，被网卡接收
> * 如果**网卡**发现数据的目标**MAC地址**是自己，就会将数据传递给上一层进行处理
> * 如果网卡发现数据的目标**MAC地址**不是自己，就会将数据丢弃，不会传递给上一层进行处理

### 2.计算机之间连接方式

#### (1)网线直连

> 直接通过网线连接。**相同设备使用交叉线，不同设备之间使用直通线。**

#### (2)同轴电缆

* 半双工通信
* 容易冲突
* 不安全
* 中间断了整个都瘫痪

#### (3)集线器

> 集线器的主要功能是对接收到的信号进行再生整形放大，以扩大网络的传输距离，同时把所有节点集中在以它为中心的节点上。
>
> 它发送数据时都是没有针对性的，而是采用广播方式发送。也就是说当它要向某节点发送数据时，不是直接把数据发送到目的节点，而是把数据包发送到与集线器相连的所有节点.集线器（HUB）属于数据通信系统中的基础设备，它和双绞线等传输介质一样，是一种不需任何软件支持或只需很少管理软件管理的硬件设备。

#### (4)网桥

> 网桥（Bridge）是早期的两端口数据链路层网络设备，用来连接不同网段的计算机网络设备同时它又可**隔离冲突域.**

#### (5)交换机

> 应用于统一网段内，有记忆功能，相当于更多接口的网桥，相当于更多的网桥，双全工通讯。

#### (6)路由器

> 可以在**不同网段**之间转发数据，**隔绝广播域**。路由器通过不同端口的**网关不同**与外界网络连接。**网关**和**对应广播域**要处于**相同网段**。



### 3.MAC地址

#### (1)组成

* 每一个**网卡**都有一个**6字节的MAC地址**(物理地址)；
* **全球唯一**，固化在了网卡的ROM中，由IEEE802标准规定；
* **前3字节**：OUI，**组织唯一标识符**，由IEEE的注册管理机构分配给厂商；
* **后3字节**：**网络接口标识符**，由厂商自行分配；

#### (2)格式

* Windows：`40-55-82-0A-8C-6D`
*  Linux、Android、Mac、iOS：`40:55:82:0A:8C:6D`
*  当48位全为1时，代表广播地址：`FF-FF-FF-FF-FF-FF`

#### (3)操作

* 查看MAC地址：`ipconfig /all`

#### (4)获取

> * 通过发送 广播获取对方的MAC地址 ，获取成功后，会缓存IP地址、MAC地址的映射信息，俗称：ARP缓存 
> * 通过ARP广播获取的MAC地址，属于动态（dynamic）缓存 ✓ 存储时间比较短（默认是2分钟），过期了就自动删除

* 查询ARP缓存：arp -a [主机地址]
* 删除ARP缓存：arp -d [主机地址]
* 增加ARP缓存：arp -s 主机地址 MAC地址

#### (5)ARP

> **ARP**译为：地址解析协议
>
> 通过IP地址获取MAC地址。

#### (6)RARP

> **RARP**译为：逆地址解析协议
>
> 使用与ARP相同的报头结构 ，作用与ARP相反，用于将**MAC地址**转换为**IP地址**，后来被BOOTP、DHCP所取代

#### (7)ICMP

> **ICMP**译为：互联网控制消息协议
>
> * IPv4中的ICMP被称作ICMPv4，IPv6中的ICMP则被称作ICMPv6 
> * 通常用于返回错误信息，比如 值过期、目的不可达
> * ICMP的错误消息总是包括了源数据并返回给发送者

### 4.IP地址

> IP地址（Internet Protocol Address）：互联网上的每一个主机都有一个IP地址 ，最初是**IPv4**版本，32bit（4字节），2019年11月25日，全球的IP地址已经用完，后面推出了**IPv6**版本，128bit（16字节）

#### (1)组成

> IP地址由2部分组成：**网络标识**（网络ID，网络标识一样说明在同一个网段）、**主机标识**（主机ID）

* 通过**子网掩码**（subnet mask）可以得知网络ID 、主机ID 
* **主机所在的网段(网络号) = 子网掩码 & IP地址**（与运算）

![image-20220530204808761](D:\Typora笔记\计算机网络\images\子网掩码.png)

```
例如：
IP地址：130.168.1.10
子网掩码：255.255.0.0
网段：130.168.0.0
所以在该网段下可以用的IP地址：256 * 256 - 2 （个）
因为：160.168.255.255为广播IP地址，160.168.0.0表示网段
```

*  计算机和其他计算机通信前，会先判断目标主机和自己是否在同一网段 ；同一网段：不需要由路由器进行转发 ；不同网段：交由路由器进行转发

#### (2)分类

![image-20220530205248892](D:\Typora笔记\计算机网络\images\IP地址分类.png)

#### (3)子网掩码的CIDR表示方法

> 子网掩码的CIDR表示方法 
>
> * 192.168.1.100/24，代表子网掩码有24个1，也就是255.255.255.0
> * 123.210.100.200/16，代表子网掩码有16个1，也就是255.255.0.0

#### (4)子网划分

> 子网划分：借用主机位作子网位，划分出多个子网
>
> 可用分为:
>
> * 等长子网划分：将一个网段等分成多个子网，每个子网的可用IP地址数量是一样的
> * 变长子网划分：每个子网的可用IP地址数量可以是不一样的

* 等分成2个子网

![image-20220530211340086](D:\Typora笔记\计算机网络\images\等分两个子网.png)

* 等分4个子网

![image-20220530211431768](D:\Typora笔记\计算机网络\images\等分四个子网.png)

* 等分8个子网

![image-20220530211528847](D:\Typora笔记\计算机网络\images\等分8个子网.png)

* 变长子网划分

![image-20220530212417018](D:\Typora笔记\计算机网络\images\变长子网划分.png)

#### (5)超网

> 超网：跟子网反过来，它是将多个连续的网段合并成一个更大的网段。

![image-20220530214846518](D:\Typora笔记\计算机网络\images\超网.png)

* 合并4个网段

![image-20220530214920793](D:\Typora笔记\计算机网络\images\合并四个网段.png)



### 5.路由

> 用于不同网段之间转发数据。
>
> 默认情况下，路由器只知道跟它直连的网段，非直连的网段需要通过静态路由、动态路由告诉它。

#### (1)静态路由

* 管理员手动添加路由信息
* 适用于小规模网络

#### (2)动态路由

* 路由器通过路由选择协议（比如RIP、OSPF）自动获取路由信息 
* 适用于大规模网络



### 6.ISP

> ◼ ISP，Internet Service Provider，Internet服务提供商，比如移动、电信、网通、铁通等。



### 7.公网IP、死亡IP

#### (1)公网IP

> Internet上的路由器中只有到达公网的路由表，没有到达私网的路由表 
>
> 公网IP由因特网信息中心，统一分配和管理
>
> ISP需要向Inter NIC 申请公网IP

#### (2)私网IP

> 主要用于局域网。下面是保留的私网网段 
>
> A类：10.0.0.0/8，1个A类网络 
>
> B类：172.16.0.0/16 ~ 172.31.0.0/16，16个B类网络 
>
> C类：192.168.0.0/24 ~ 192.168.255.0/24，256个C类网络



### 8.NAT

> 私网IP访问Internet需要进行NAT转换为公网IP
>
> 特点：节约公网IP资源、会隐藏真实IP

**NAT分类**：

* 静态转换
* * 手动配置NAT映射表
  * 一对一转换
* 动态转换
* * 定义外部地址池，动态随机转换
  * 一对一转换
* PAT
* * 多对一转换，最大程度节约公网IP资源
  * 采用多端多路复用方式，通过端口号标识不同的数据流
  * 目前应用最广泛的NAT实现方式
